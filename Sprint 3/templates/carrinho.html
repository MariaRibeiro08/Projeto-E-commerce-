<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Zados - Seu Carrinho</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="icon" href="{{ url_for('static', path='uploads/Logo_SF_Branca.PNG') }}" type="image/x-icon">
  <style>
    /* RESET */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      background: #fff;
      color: #000;
      line-height: 1.6;
    }

    html, body {
      overflow-x: hidden;
    }

    /* HEADER */
    header {
      width: 100%;
      top: 0;
      background: #FBF4E6;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 100;
    }

    header h1 {
      font-size: 50px;
      margin-left: -840px;
    }

    .LogoMark {
      width: 100px;
      height: 100px;
      border-radius: 6px;
    }

    nav {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    nav a {
      text-decoration: none;
      color: #000;
      font-size: 20px;
      margin: 0 10px;
    }

    .headerimg img {
      width: 30px;
      vertical-align: middle;
    }

    .botao_entrar {
      background: #000;
      color: #fff;
      border: none;
      padding: 12px 18px;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }

    .botao_entrar:hover {
      background: gray;
    }

/* BARRA EST√ÅTICA DE ETAPAS */
.checkout-bar {
  display: flex;
  justify-content: center;
  margin: 40px 0 30px 0;
  padding: 0 16px;
}

.checkout-bar__inner {
  display: flex;
  width: min(950px, 100%);
  background: #FBF4E6;          /* Bege suave do site */
  border: 2px solid #d9cdb7;    /* Contorno delicado */
  border-radius: 12px;
  overflow: hidden;
  text-align: center;
  font-family: "Inter", sans-serif;
}

.checkout-bar__inner .step {
  flex: 1;
  padding: 14px 0;
  font-weight: 600;
  color: #222;
  font-size: 15px;
  border-right: 1px solid rgba(0, 0, 0, 0.05);
}

.checkout-bar__inner .step:last-child {
  border-right: none;
}

/* Etapa atual (ex: carrinho) */
.checkout-bar__inner .step.current {
  background: #000;
  color: #fff;
}

/* Responsividade: empilha em telas menores */
@media (max-width: 600px) {
  .checkout-bar__inner {
    flex-direction: column;
    border-radius: 10px;
  }

  .checkout-bar__inner .step {
    border-right: none;
    border-bottom: 1px solid rgba(0, 0, 0, 0.05);
  }

  .checkout-bar__inner .step:last-child {
    border-bottom: none;
  }
}


    /* CARRINHO */
    .carrinho {
      max-width: 950px;
      margin: auto;
      text-align: center;
      padding: 20px;
    }
    .produto {
      display: grid;
      grid-template-columns: 120px 1fr 160px 120px 40px;
      align-items: center;
      background: #fff;
      border-radius: 10px;
      padding: 18px;
      margin-bottom: 18px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      border: 1px solid #e6e6e6;
    }
    .produto img {
      width: 100px;
      height: auto;
      border-radius: 8px;
      object-fit: cover;
    }
    .produto .info p { margin: 4px 0; color: #333; font-size: 14px; }
    .quantidade button {
      border: 1px solid #000;
      padding: 6px 12px;
      cursor: pointer;
      background: none;
      border-radius: 6px;
    }
    .quantidade span { margin: 0 10px; font-weight: 600; }
    .valor { font-weight: 700; color: #111; }
    .delete { background: none; border: none; cursor: pointer; color: #333; font-size: 18px; }

    /* RESUMO */
    .resumo {
      background: #fff;
      border-radius: 8px;
      padding: 18px;
      margin-top: 28px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      text-align: left;
      border: 1px solid #e6e6e6;
    }
    .resumo p { 
      display:flex; 
      justify-content:space-between; 
      margin: 8px 0; 
      color:#333; 
    }
    .resumo hr { 
      border: none; 
      border-top: 1px solid #eee; 
      margin: 12px 0; 
    }

    /* BOT√ÉO */
    .continuar {
      background: #000;
      color: #fff;
      padding: 14px 26px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      margin-top: 20px;
    }

    .fale { display:block; margin-top:14px; color:#000; text-decoration:none; font-weight:600; }

    /* FOOTER */
    .footer-end {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 40px;
      background: url("{{ url_for('static', path='uploads/Footer-home.PNG') }}") no-repeat center/cover;
      padding: 50px 60px;
      margin-top: 60px;
    }
    .footer-col h4 { 
      font-size: 18px; 
      margin-bottom: 12px; 
    }
    .footer-col ul { 
      list-style: none; 
      padding:0; 
      margin:0; 
    }
    .footer-col ul li { 
      margin: 6px 0; 
    }
    .footer-col ul li a { 
      text-decoration:none; 
      color:#000; 
      font-size:14px;
    }
    .footer-col .social img { 
      width: 30px; 
      margin-top: 12px; 
    }
    @media (max-width: 820px) {
      .produto { 
        grid-template-columns: 100px 1fr 110px 100px 40px; 
        gap:8px; 
      }
      .carrinho { 
        padding: 10px; 
      }
      .header { 
        padding: 10px 16px; 
      }
      .footer-end { 
        padding: 30px; 
        grid-template-columns: 1fr; 
      }
    }

    .saiba_btn{
      font-size: 16x;
      margin-top: 20px; 
      height: 20px;
      background-color: rgba(255, 255, 255, 0);
      cursor: pointer;
      border-color: #00000000;
      border-radius: 2px;
      box-shadow: 1px 1px 1rem #3333334d;
    }   
  </style>
</head>

<body>
<!-- HEADER -->
<header>
  <img class="LogoMark" src="{{ url_for('static', path='uploads/Logo.png') }}" alt="Logo_Zados">
  <h1>ZADOS</h1>
  <nav>
    <a href="/busca" class="nav_item">BUSCA</a>
    <a href="/busca" class="headerimg"><img src="{{ url_for('static', path='uploads/lupa.png') }}" alt="lupa"></a>
    <a href="/" class="nav_item">CAT√ÅLOGO</a>
    <a href="/" class="headerimg"><img src="{{ url_for('static', path='uploads/loja.png') }}" alt="loja"></a>
    <a href="/home" class="nav_item">Home</a>
    <a href="/home" class="headerimg"><img src="{{ url_for('static', path='uploads/casa.png') }}" alt="home"></a>
    <a href="/login" class="botao_entrar">ENTRAR</a>
  </nav>
</header>

<div class="checkout-bar">
  <div class="checkout-bar__inner">
    <div class="step current">1 CARRINHO</div>
    <div class="step">2 IDENTIFICA√á√ÉO</div>
    <div class="step">3 PAGAMENTO</div>
  </div>
</div>


<!-- CARRINHO -->
<section class="carrinho">
  <h1>Seu Carrinho</h1>

  <div id="lista-produtos"></div>

  <div class="resumo">
    <h3>Resumo do pedido</h3>
    <p><span>Subtotal:</span><span id="subtotal">R$ 0,00</span></p>
    <p><span>Frete:</span><span>Gr√°tis</span></p>
    <hr>
    <p><strong>Total:</strong><strong id="total">R$ 0,00</strong></p>
  </div>

  <button class="continuar" onclick="finalizarCompra()">Continuar</button>
  <a class="fale" href="/">‚Üê Voltar √† loja</a>
</section>

<!-- FOOTER -->
<footer>
  <div class="footer-end">
    <div class="footer-col">
      <h4>Zados</h4>
      <div class="social">
        <a href="#"><img src="{{ url_for('static', path='uploads/FacebookIcon.png') }}" alt="Facebook"/></a>
        <a href="#"><img src="{{ url_for('static', path='uploads/IGIcon.png') }}" alt="Instagram"/></a>
        <a href="#"><img src="{{ url_for('static', path='uploads/YTIcon.png') }}" alt="Youtube"/></a>
      </div>
    </div>
    <div class="footer-col">
      <h4>Camisetas</h4>
      <ul>
        <li><a href="#">Oversize</a></li>
        <li><a href="#">Regata</a></li>
        <li><a href="#">Manga-longa</a></li>
      </ul>
    </div>
    <div class="footer-col">
      <h4>Camisas</h4>
      <ul>
        <li><a href="#">Polo</a></li>
        <li><a href="#">Social</a></li>
        <li><a href="#">Colarinho longo</a></li>
        <a class="saiba_btn" href="/sobre">Saiba Mais</a>
      </ul>
    </div>
  </div>
</footer>

<script>
  // Caminho base das imagens dentro de static/uploads
  const baseUploadPath = "/static/uploads/";
  const defaultProductImage = "/static/uploads/sem-foto.png";

  // üîß Fun√ß√£o corrigida
  function resolveImage(imgName) {
    if (!imgName) return defaultProductImage;
    // se j√° vier com / ou http, usa direto
    if (imgName.startsWith('/') || imgName.startsWith('http')) return imgName;
    // remove "uploads/" duplicado, se existir
    imgName = imgName.replace(/^uploads\//, '');
    // caminho relativo dentro de static/uploads
    return baseUploadPath + imgName;
  }

  function carregarCarrinho() {
    const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    const lista = document.getElementById('lista-produtos');
    const subtotalElem = document.getElementById('subtotal');
    const totalElem = document.getElementById('total');

    lista.innerHTML = '';
    let subtotal = 0;

    if (carrinho.length === 0) {
      lista.innerHTML = '<p>Seu carrinho est√° vazio üò¢</p>';
    } else {
      carrinho.forEach(item => {
        const preco = Number(item.preco) || 0;
        const totalItem = preco * (item.quantidade || 1);
        subtotal += totalItem;

        const imgSrc = resolveImage(item.imagem);

        const div = document.createElement('div');
        div.className = 'produto';
        div.innerHTML = `
          <img src="${imgSrc}" alt="${(item.nome || '').replace(/"/g,'')}">
          <div class="info">
            <p><strong>${item.nome || 'Produto'}</strong></p>
            <p>Quantidade: ${item.quantidade || 1}</p>
            <p>Cor: ${item.cor || '‚Äî'}</p>
            <p>Tamanho: ${item.tamanho || '‚Äî'}</p>
          </div>
          <div class="quantidade">
            <button onclick="alterarQtd(${item.id}, -1)">-</button>
            <span>${item.quantidade || 1}</span>
            <button onclick="alterarQtd(${item.id}, 1)">+</button>
          </div>
          <div class="valor">R$ ${totalItem.toFixed(2)}</div>
          <button class="delete" onclick="removerItem(${item.id})" title="Remover item">‚úñ</button>
        `;
        lista.appendChild(div);
      });
    }

    subtotalElem.textContent = "R$ " + subtotal.toFixed(2);
    totalElem.textContent = "R$ " + subtotal.toFixed(2);
  }

  function alterarQtd(id, delta) {
    let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    carrinho = carrinho.map(item => {
      if (item.id === id) {
        item.quantidade = Math.max(1, (item.quantidade || 1) + delta);
      }
      return item;
    });
    localStorage.setItem('carrinho', JSON.stringify(carrinho));
    carregarCarrinho();
  }

  function removerItem(id) {
    let carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
    carrinho = carrinho.filter(item => item.id !== id);
    localStorage.setItem('carrinho', JSON.stringify(carrinho));
    carregarCarrinho();
  }

  function finalizarCompra() {
    alert("Compra finalizada! Obrigado pela prefer√™ncia üíõ");
    localStorage.removeItem('carrinho');
    carregarCarrinho();
  }

  // Carrega o carrinho ao abrir a p√°gina
  carregarCarrinho();
</script>
</body>
</html>
